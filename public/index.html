<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tarot Reading</title>
    <style>
	@import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Raleway:wght@300;400;700&display=swap');
	
		/* üåü Magical Scrollbar */
		::-webkit-scrollbar {
			border-radius: 2px;
			width: 2px;
		}

		::-webkit-scrollbar-track {
			background: transparent;
		}

		::-webkit-scrollbar-thumb {
			background: linear-gradient(120deg, #ffffff 30%, #c0c0c0 50%, #000000 70%);
			background-size: 200% 100%;
			border-radius: 10px;
			animation: shimmer-wand 2s infinite linear;;
			box-shadow: 0 0 5px rgba(255, 255, 255, 0.4);
		}

		@keyframes shimmer-wand {
			0% {
				background-position: -100% 0;
			}
			100% {
				background-position: 100% 0;
			}
		}

		/* Firefox (optional fallback) */
		* {
			scrollbar-color: #c0c0c0 transparent;
			scrollbar-width: thin;
		}

        
        :root {
            --background-dark: #121212;
            --background-light: #f0f0f0;
            --text-dark: #ffffff;
            --text-light: #000000;
            --card-back-dark: #bbb;
            --card-back-light: #fff;
        }

        body {
            font-family: 'Raleway', sans-serif;
            background-color: var(--background-dark);
            color: var(--text-dark);
            text-align: center;
            padding: 20px;
            transition: background 0.5s, color 0.5s;
        }

        body.light-mode {
            background-color: var(--background-light);
            color: var(--text-light);
        }

        h1 {
            font-family: 'Cinzel', serif;
            font-size: 36px;
            margin-bottom: 10px;
            text-shadow: 0px 0px 10px rgba(255, 255, 255, 0.6);
        }

        .toggle-container {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            align-items: center;
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 40px;
            height: 20px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 20px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 14px;
            width: 14px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
		
		input {
            width: 80%;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            border: none;
            background-color: #333;
            color: white;
            font-size: 16px;
        }

        input:checked + .slider {
            background-color: #8b5cf6;
        }

        input:checked + .slider:before {
            transform: translateX(20px);
        }

        .quick-access {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }

        .quick-access button {
            background: linear-gradient(45deg, #8b5cf6, #d946ef);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .quick-access button:hover {
            transform: scale(1.05);
        }
		
        #cards {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }
		

		.card-wrapper {
			display: flex;
			justify-content: center;
			gap: 1px;
			flex-wrap: wrap;
			padding: 0 10px;
			max-width: 100%;
			box-sizing: border-box;
		}


		@keyframes magical-appear {
			0% {
				transform: scale(0.5) rotateY(90deg);
				opacity: 0;
			}
			100% {
				transform: scale(1) rotateY(0deg);
				opacity: 1;
			}
		}


		.card {
			flex: 1 1 calc(33.333% - 5px); /* Three cards per row with gap accounted */
			max-width: 160px;
			aspect-ratio: 1.6 / 3;
			perspective: 1000px;
			cursor: pointer;
			border-radius: 10px;
			transition: transform 0.5s ease;
			box-sizing: border-box;
		}


		.card-inner {
			width: 100%;
			height: 100%;
			position: relative;
			transform-style: preserve-3d;
			transition: transform 1s;
		}

        .card.flipped .card-inner {
            transform: rotateY(180deg);
        }

        .card-front, .card-back {
            width: 100%;
            height: 100%;
            position: absolute;
            backface-visibility: hidden;
        }

        .card-front img, .card-back img {
            width: 100%;
            height: 100%;
            border-radius: 10px;
        }

        .card-back {
            transform: rotateY(180deg);
        }
		
		.card::after {
			content: attr(data-tooltip);
			position: absolute;
			bottom: -40px;
			left: 50%;
			transform: translateX(-50%);
			white-space: nowrap;
			font-size: 14px;
			font-weight: 500;
			padding: 6px 12px;
			border-radius: 6px;
			background: linear-gradient(120deg, #f0f0f0 30%, #cccccc 50%, #f0f0f0 70%);
			background-size: 200% 100%;
			color: #121212;
			opacity: 0;
			pointer-events: none;
			transition: opacity 0.3s ease, transform 0.3s ease;
			z-index: 10;
			box-shadow: 0 0 8px rgba(192, 192, 192, 0.5);
			animation: shimmer-tooltip 2s infinite linear;
		}

		.card:hover::after {
			opacity: 1;
			transform: translateX(-50%) translateY(-4px);
		}

		@keyframes shimmer-tooltip {
			0% {
				background-position: -100% 0;
			}
			100% {
				background-position: 100% 0;
			}
		}

		body.light-mode .card::after {
			background: linear-gradient(120deg, #ffffff 30%, #dddddd 50%, #ffffff 70%);
			background-size: 200% 100%;
			color: #000;
			box-shadow: 0 0 8px rgba(160, 160, 160, 0.4);
			animation: shimmer-tooltip 2s infinite linear;
		}


		
		#cards { display: flex; justify-content: center; margin-top: 20px; }
		.card { width: 150px; height: 250px; margin: 10px; perspective: 1000px; }
		
		.card-front { background-color: #bbb; display: flex; align-items: center; justify-content: center; }
		.card-back { background-color: #fff; transform: rotateY(180deg); }
		img { width: 100%; height: auto; }
		
		button {
            padding: 10px 15px;
            background-color: #8b5cf6;
            color: white;
            border: none;
            cursor: pointer;
            border-radius: 5px;
            font-size: 16px;
            transition: background 0.3s;
        }

        button:hover {
            background-color: #6d28d9;
        }
		
        #insight {
			margin-top: 20px;
			font-size: 16.5px;
			text-align: justify;
			max-width: 600px;
			margin-left: auto;
			margin-right: auto;
			padding: 15px 20px;
			background-color: var(--insight-dark);
			border-radius: 8px;
			opacity: 1;
			transition: opacity 0.8s ease;
			line-height: 1.6;
			white-space: pre-line;
		}

		.show-insight {
			opacity: 1;
			animation: fadeIn 0.8s ease;
		}

		@keyframes fadeIn {
			from { opacity: 0; transform: translateY(10px); }
			to { opacity: 1; transform: translateY(0); }
		}
		@keyframes shimmer {
			0% {
				background-position: -100% 0;
			}
			100% {
				background-position: 100% 0;
			}
		}

		.loading-message {
			position: relative;
			font-style: bold italic;
			font-size: 20px;
			text-align: left;
			padding: 10px;
			overflow: hidden;
			background: linear-gradient(120deg, #fafafa 30%, #c0c0c0 50%, #78706e 70%);
			background-size: 200% 100%;
			-webkit-background-clip: text;
			-webkit-text-fill-color: transparent;
			animation: shimmer 2s infinite linear;
			color: #fff;
			font-weight: 500;
		}



        body.light-mode #insight {
            background-color: var(--insight-light);
            color: var(--text-light);
        }
		
		/* Temporary theme classes to allow transition */
		.dark-mode-temp {
			background-color: #121212;
			color: white;
		}
		.light-mode-temp {
			background-color: #f0f0f0;
			color: black;
		}

		/* Optional: Smooth toggle animation */
		.animate-toggle + .slider {
			box-shadow: 0 0 1px 1px #8b5cf6;
			transition: box-shadow 1s ease-in-out;
		}
    </style>
</head>
<body data-theme="auto">
    <div class="toggle-container">
        <label>üåô</label>
        <label class="toggle-switch">
            <input type="checkbox" id="themeToggle">
            <span class="slider"></span>
        </label>
    </div>
    
    <h1>üåô Tarot Reading ‚ú®</h1>

	<section id='prompt_section'>
		<div class="quick-access">
			<button onclick="setQuestion('What does my future hold?'); performReading();">üîÆ What does my future hold?</button>
			<button onclick="setQuestion('What should I focus on today?'); performReading();">üåü What should I focus on today?</button>
			<button onclick="setQuestion('How can I find love?'); performReading();">‚ù§Ô∏è How can I find love?</button>
		</div>

		<input type="text" id="question" placeholder="Enter your question here...">
		<button onclick="performReading()">Get Reading</button>
	</section>	
	
	<section id='cards_section'>
		<div id="cards" class="card-wrapper"></div>
	</section>	
	
	<section id='insight_section'>
		<div id="insight"></div>
	</section>
	
	<script>
	const cardImages = ['Ace of Cups.jpg', 'Ace of Pentacles.jpg', 'Ace of Swords.jpg', 'Ace of Wands.jpg', 'Death.jpg', 'Eight of Cups.jpg', 'Eight of Pentacles.jpg', 'Eight of Swords.jpg', 'Eight of Wands.jpg', 'Eleven of Cups.jpg', 'Eleven of Pentacles.jpg', 'Eleven of Swords.jpg', 'Eleven of Wands.jpg', 'Five of Cups.jpg', 'Five of Pentacles.jpg', 'Five of Swords.jpg', 'Five of Wands.jpg', 'Four of Cups.jpg', 'Four of Pentacles.jpg', 'Four of Swords.jpg', 'Four of Wands.jpg', 'Fourteen of Cups.jpg', 'Fourteen of Pentacles.jpg', 'Fourteen of Swords.jpg', 'Fourteen of Wands.jpg', 'Judgement.jpg', 'Justice.jpg', 'Nine of Cups.jpg', 'Nine of Pentacles.jpg', 'Nine of Swords.jpg', 'Nine of Wands.jpg', 'Seven of Cups.jpg', 'Seven of Pentacles.jpg', 'Seven of Swords.jpg', 'Seven of Wands.jpg', 'Six of Cups.jpg', 'Six of Pentacles.jpg', 'Six of Swords.jpg', 'Six of Wands.jpg', 'Strength.jpg', 'Temperance.jpg', 'Ten of Cups.jpg', 'Ten of Pentacles.jpg', 'Ten of Swords.jpg', 'Ten of Wands.jpg', 'TheChariot.jpg', 'TheDevil.jpg', 'TheEmperor.jpg', 'TheEmpress.jpg', 'TheFool.jpg', 'TheHangedMan.jpg', 'TheHermit.jpg', 'TheHierophant.jpg', 'TheHighPriestess.jpg', 'TheLovers.jpg', 'TheMagician.jpg', 'TheMoon.jpg', 'TheStar.jpg', 'TheSun.jpg', 'TheTower.jpg', 'TheWorld.jpg', 'Thirteen of Cups.jpg', 'Thirteen of Pentacles.jpg', 'Thirteen of Swords.jpg', 'Thirteen of Wands.jpg', 'Three of Cups.jpg', 'Three of Pentacles.jpg', 'Three of Swords.jpg', 'Three of Wands.jpg', 'Twelve of Cups.jpg', 'Twelve of Pentacles.jpg', 'Twelve of Swords.jpg', 'Twelve of Wands.jpg', 'Two of Cups.jpg', 'Two of Pentacles.jpg', 'Two of Swords.jpg', 'Two of Wands.jpg', 'WheelOfFortune.jpg']
	document.addEventListener("DOMContentLoaded", () => {
		const now = new Date();
		const hour = now.getHours();
		const isDayTime = hour >= 6 && hour < 18;

		const body = document.body;
		const themeToggle = document.getElementById("themeToggle");

		// Load opposite theme first
		const prefersLight = isDayTime;
		if (prefersLight) {
			body.classList.add('dark-mode-temp');
			themeToggle.checked = false;
		} else {
			body.classList.add('light-mode-temp');
			themeToggle.checked = true;
		}

		// Animate to actual theme after delay
		setTimeout(() => {
			if (prefersLight) {
				body.classList.add('light-mode');
				body.classList.remove('dark-mode-temp');
				themeToggle.checked = true;
			} else {
				body.classList.remove('light-mode-temp');
				themeToggle.checked = false;
			}
			themeToggle.classList.add('animate-toggle');
		}, 2000);
	});
	document.getElementById('themeToggle').addEventListener('change', function() {
		document.body.classList.toggle('light-mode');
	});
	
	function setQuestion(text) {
		document.getElementById('question').value = text;
	}

	function toggleTheme() {
		document.body.classList.toggle('light-mode');
	}
	
	function setQuestion(text) {
		document.getElementById('question').value = text;
	}
 
	function performReading() {
	
	  const question = document.getElementById('question').value;
	  if (!question) {
		alert('Please enter a question.');
		return;
	  }

	  const selectedCards = [];
	  for (let i = 0; i < 3; i++) {
		const randomIndex = Math.floor(Math.random() * cardImages.length);
		selectedCards.push(cardImages[randomIndex]);
	  }

	displayCards(selectedCards);
	document.getElementById('cards_section').scrollIntoView({ behavior: 'smooth' });
	fetchInsight(question, selectedCards);
	}
	//giving tooltip to cards
	

	function displayCards(cards) {
		const cardsContainer = document.getElementById('cards');
		cardsContainer.innerHTML = '';

		cards.forEach((card, index) => {
			const cardElement = document.createElement('div');
			cardElement.className = 'card';
			const cleanName = card.replace(/\.[^/.]+$/, '').replace(/([a-z])([A-Z])/g, '$1 $2');
			cardElement.setAttribute('data-tooltip', cleanName);
			cardElement.innerHTML = `
				<div class="card-inner">
					<div class="card-front">
						<img src="images/card_back/card_back.png" alt="Tarot Card">
					</div>
					<div class="card-back">
						<img src="images/card_front/${card}" alt="Tarot Card">
					</div>
				</div>
			`;
			cardsContainer.appendChild(cardElement);

			// Delay the flip
			setTimeout(() => {
				cardElement.classList.add('flipped');
			}, 1500); // 1 second delay after cards appear
		});
	}

//after this insights part try not to touch
	async function fetchInsight(question, cards) {
		const insightDiv = document.getElementById('insight');
		insightDiv.classList.remove('show-insight');
		insightDiv.innerHTML = `<div class="loading-message">‚ú® Interpreting the cosmic energies...</div>`;

		const response = await fetch('https://tarotreading-1.onrender.com/get-insight', {
			method: 'POST',
			headers: { 'Content-Type': 'application/json' },
			body: JSON.stringify({ question, cards })
		});

		const data = await response.json();
		const rawText = data.insight;

		// Bold **text** using RegEx
		const formattedText = rawText; // Keep original with **bold** markers

		// Typing effect
		function parseFormattedText(text) {
		const segments = [];
		let remaining = text;
		let match;

		const boldRegex = /\*\*(.*?)\*\*/;

		while ((match = boldRegex.exec(remaining)) !== null) {
			if (match.index > 0) {
				segments.push({ text: remaining.slice(0, match.index), bold: false });
			}
			segments.push({ text: match[1], bold: true });
			remaining = remaining.slice(match.index + match[0].length);
		}

		if (remaining) {
			segments.push({ text: remaining, bold: false });
		}

		return segments;
	}

	async function displayAnimatedInsight(text) {
		const segments = parseFormattedText(text);
		const container = document.getElementById('insight');
		container.innerHTML = '';
		container.classList.add('show-insight');

		for (const segment of segments) {
			const span = document.createElement(segment.bold ? 'strong' : 'span');
			container.appendChild(span);

			for (let i = 0; i < segment.text.length; i++) {
				span.textContent += segment.text[i];
				await new Promise(res => setTimeout(res, 12));
			}
		}
	}
	setTimeout(() => displayAnimatedInsight(formattedText), 300);
	}

	
	</script>
	</body>
	</html>


